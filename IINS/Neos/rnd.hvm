// (Rnd 0 s) = (List.nil)
// (Rnd n s) = (List.cons s (Rnd (- n 1) (% (+ (* s 1664525) 1013904223) 4294967296)))
// (Main n) = (Rnd (<< 1 14) 1)

(U60.if 0 t f) = f
(U60.if n t f) = t

(Dbg x) = (HVM.log x x)
(Gen x) = (U60.if (< x 1) [] (Data.List.cons x (Dbg (Gen (- x 1)))))
(Main) = (Gen 10)

// Index (List.cons v vs) Zero = v
// Index (List.cons v vs) (Succ n) = Index vs n

// Eval env (Var n) = Index env n
// Eval env (Lam e) = λv (Eval (List.cons v env) e)
// Eval env (App e1 e2) = (Eval env e1) (Eval env e2)

// One = Lam (Lam (App (Var (Succ Zero)) (Var Zero)))
// Two = Lam (Lam (App (Var (Succ Zero)) (App (Var (Succ Zero)) (Var Zero))))
// Unchurch f = f λx(+ x 1) 0

// Main = Unchurch (Eval List.nil (App One Two))

// (Index (List.cons v vs) (Zero)) = v
// (Index (List.cons v vs) (Succ n)) = (Index vs n)

// (Eval env (Var n)) = (Index env n)
// (Eval env (Lam e)) = (@v (Eval (List.cons v env) e))
// (Eval env (App e1 e2)) = ((Eval env e1) (Eval env e2))

// (One) = (Lam (Lam (App (Var (Succ (Zero))) (Var (Zero))))) 
// (Two) = (Lam (Lam (Lam (App (Var (Succ (Zero))) (App (Var (Succ (Zero))) (Var (Zero)))))))

// (Unchurch f) = (f @x(+ x 1) 0)

// Main = (Unchurch (Eval (List.nil) (App (One) (Two))))